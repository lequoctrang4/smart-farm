DROP DATABASE `farm1`;
create database if not exists `farm`;
use `farm`;

CREATE TABLE if not EXISTS `farm` (
  `id` int(10) NOT NULL PRIMARY KEY,
  `name` varchar(100) NOT NULL,
  `address` varchar(200) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

CREATE TABLE if not EXISTS `control_equipment` (
  `id` varchar(10) NOT NULL PRIMARY KEY,
  `name` varchar(100) NOT NULL,
  `status` int(10) NOT NULL DEFAULT 0,
  `date_add` date NOT NULL DEFAULT CURRENT_DATE,
  `image` varchar(100),
  `farm_id` int(10) NOT NULL,
  FOREIGN KEY (`farm_id`) REFERENCES `farm` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

CREATE TABLE if not EXISTS `data_equipment` (
  `id` varchar(10) NOT NULL PRIMARY KEY,
  `name` varchar(100) NOT NULL,
  `date_add` date NOT NULL DEFAULT CURRENT_DATE,
  `min` int(11) NOT NULL DEFAULT 0,
  `min_action` varchar(10),
  `max` int(11) NOT NULL DEFAULT 0,
  `max_action` varchar(10),
  `auto` int(10) NOT NULL DEFAULT 0,
  `image` varchar(100),
  `farm_id` int(10) NOT NULL,
  FOREIGN KEY (`farm_id`) REFERENCES `farm` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  FOREIGN KEY (`min_action`) REFERENCES `control_equipment` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  FOREIGN KEY (`max_action`) REFERENCES `control_equipment` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

CREATE TABLE if not EXISTS `data` (
  `id` varchar(10) NOT NULL,
  `time` datetime NOT NULL,
  `data` FLOAT(20) NOT NULL,
  PRIMARY KEY (`id`,`time`),
  FOREIGN KEY (`id`) REFERENCES `data_equipment` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;



CREATE TABLE if not EXISTS `user` (
  `id` int(10) PRIMARY KEY AUTO_INCREMENT,
  `name` varchar(100) NOT NULL,
  `bdate` date,
  `gender` varchar(20) NOT NULL check (`gender` = 'Nam' or `gender` = 'Nữ' or `gender` = 'Khác'),
  `phone_number` varchar(20) UNIQUE NOT NULL,
  `email` varchar(100) NOT NULL,
  `password` varchar(250) NOT NULL,
  `register_at` date NOT NULL,
  `avatar` varchar(100),
  `isAdmin` int(1) NOT NULL DEFAULT 0
)


CREATE TABLE if not EXISTS `statistical` (
  `id` int(10) NOT NULL PRIMARY KEY,
  `name` int(100) NOT NULL,
  `description` varchar(200) NOT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_general_ci;

INSERT INTO `farm` (`id`, `name`, `address`) VALUES
(1, 'Trang trại 1', 'Khu A'),
(2, 'Trang trại 2', 'Khu B'),
(3, 'Trang trại 3', 'Khu C');

INSERT INTO `control_equipment` (`id`, `name`, `status`, `date_add`, `image`, `farm_id`) VALUES
('v10', 'Máy bơm', 0, '2023-04-08', 'v10.jpg', 1),
('v11', 'Đèn', 0, '2023-04-08', 'v11.jpg', 1);

INSERT INTO `data_equipment` (`id`, `name`, `date_add`, `min`, `min_action`, `max`, `max_action`, `image`, `farm_id`) VALUES
('v1', 'Cảm biến nhiệt độ', '2023-04-08', 20, NULL, 30, NULL, 'v1.jpg', 1),
('v2', 'Cảm biến độ ẩm không khí', '2023-04-08', 20, NULL, 30, NULL, 'v2.jpg', 1),
('v3', 'Cảm biến độ ẩm đất', '2023-04-08', 20, 'v10', 30, NULL, 'v3.jpg', 1),
('v4', 'Cảm biến ánh sáng', '2023-04-08', 20, 'v11', 30, NULL, 'v4.jpg', 1);

INSERT INTO `user` (`id`, `name`, `bdate`, `gender`, `phone_number`, `email`, `password`, `register_at`, `avatar`, `isAdmin`) VALUES
(1, 'Lê Quốc Trạng', NULL, 'Khác', '0399609015', 'lequoctrang4@gmail.com', '$2a$12$gFHY6dkZT5iPaYZs/sFOGugJhaK4Wt1op1AoMS67w9EAeDyTxGW7m', '2023-04-08', NULL, 0),
(2, 'Gia Huy', NULL, 'Khác', '0828479273', 'giahuy575621@gmail.com', '$2a$12$ZHWR/vG9wzAXNiWEO7lR4ewi.DnaaQBwKfSe/s62p5ITTC5dCacfq', '2023-04-08', NULL, 0);


INSERT INTO `data` (`id`, `time`, `data`) VALUES
('v1', '2023-04-18 23:12:47', 31.6),
('v1', '2023-04-18 23:14:48', 31.6),
('v1', '2023-04-18 23:15:17', 31.6),
('v1', '2023-04-18 23:15:46', 31.6),
('v1', '2023-04-18 23:16:16', 31.6),
('v1', '2023-04-18 23:16:46', 31.7),
('v1', '2023-04-18 23:17:16', 31.7),
('v1', '2023-04-18 23:17:46', 31.8),
('v1', '2023-04-18 23:18:16', 31.8),
('v1', '2023-04-18 23:18:46', 31.8),
('v1', '2023-04-18 23:19:16', 31.8),
('v1', '2023-04-18 23:19:47', 31.8),
('v1', '2023-04-18 23:20:16', 31.8),
('v1', '2023-04-18 23:20:48', 31.8),
('v1', '2023-04-18 23:21:17', 31.8),
('v1', '2023-04-18 23:21:46', 31.8),
('v1', '2023-04-18 23:22:16', 31.8),
('v1', '2023-04-18 23:24:13', 31.8),
('v1', '2023-04-18 23:24:43', 31.8),
('v1', '2023-04-18 23:25:13', 31.8),
('v1', '2023-04-18 23:25:43', 31.8),
('v1', '2023-04-18 23:26:13', 31.8),
('v1', '2023-04-18 23:26:43', 31.8),
('v1', '2023-04-18 23:27:13', 31.8),
('v1', '2023-04-18 23:27:43', 31.8),
('v1', '2023-04-18 23:28:13', 31.8),
('v1', '2023-04-18 23:28:44', 31.8),
('v1', '2023-04-18 23:29:13', 31.8),
('v1', '2023-04-18 23:29:43', 31.8),
('v1', '2023-04-18 23:30:23', 31.8),
('v1', '2023-04-18 23:30:55', 31.8),
('v1', '2023-04-18 23:31:25', 31.8),
('v1', '2023-04-18 23:31:53', 31.8),
('v1', '2023-04-18 23:32:25', 31.9),
('v1', '2023-04-18 23:32:53', 31.8),
('v1', '2023-04-18 23:33:23', 31.9),
('v1', '2023-04-18 23:33:53', 31.9),
('v1', '2023-04-18 23:34:23', 31.9),
('v1', '2023-04-18 23:36:08', 31.9),
('v1', '2023-04-18 23:36:37', 31.9),
('v1', '2023-04-18 23:37:08', 31.9),
('v1', '2023-04-18 23:39:18', 31.9),
('v1', '2023-04-18 23:42:20', 31.8),
('v1', '2023-04-18 23:42:50', 31.9),
('v1', '2023-04-18 23:43:20', 31.9),
('v1', '2023-04-18 23:43:50', 31.9),
('v1', '2023-04-18 23:44:20', 31.9),
('v1', '2023-04-18 23:44:50', 31.9),
('v1', '2023-04-18 23:45:43', 31.9),
('v1', '2023-04-18 23:46:47', 31.9),
('v1', '2023-04-18 23:47:17', 31.9),
('v1', '2023-04-18 23:48:40', 31.9),
('v1', '2023-04-18 23:49:09', 31.9),
('v1', '2023-04-18 23:49:56', 31.9),
('v1', '2023-04-18 23:51:30', 32),
('v1', '2023-04-18 23:52:37', 32),
('v1', '2023-04-18 23:53:07', 31.9),
('v1', '2023-04-18 23:53:37', 32),
('v1', '2023-04-18 23:54:08', 32),
('v1', '2023-04-18 23:54:37', 32),
('v1', '2023-04-18 23:55:07', 31.9),
('v1', '2023-04-18 23:55:37', 31.9),
('v1', '2023-04-18 23:56:07', 31.9),
('v1', '2023-04-18 23:56:37', 31.9),
('v1', '2023-04-18 23:57:07', 31.9),
('v1', '2023-04-18 23:59:53', 31.9),
('v1', '2023-04-19 00:00:23', 31.9),
('v1', '2023-04-19 00:00:53', 31.9),
('v1', '2023-04-19 00:01:23', 32),
('v1', '2023-04-19 00:02:34', 32),
('v1', '2023-04-19 00:03:05', 32),
('v1', '2023-04-19 00:03:34', 32),
('v1', '2023-04-19 00:04:04', 32),
('v2', '2023-04-18 23:12:49', 68.8),
('v2', '2023-04-18 23:14:50', 68.8),
('v2', '2023-04-18 23:15:17', 68.8),
('v2', '2023-04-18 23:15:46', 68.8),
('v2', '2023-04-18 23:16:17', 68.8),
('v2', '2023-04-18 23:16:46', 68.8),
('v2', '2023-04-18 23:17:16', 68.8),
('v2', '2023-04-18 23:17:46', 68.9),
('v2', '2023-04-18 23:18:16', 68.6),
('v2', '2023-04-18 23:18:46', 68.7),
('v2', '2023-04-18 23:19:16', 68.8),
('v2', '2023-04-18 23:19:46', 68.8),
('v2', '2023-04-18 23:20:16', 68.8),
('v2', '2023-04-18 23:20:47', 68.8),
('v2', '2023-04-18 23:21:17', 68.9),
('v2', '2023-04-18 23:21:47', 69),
('v2', '2023-04-18 23:22:16', 69),
('v2', '2023-04-18 23:24:13', 69.1),
('v2', '2023-04-18 23:24:43', 69),
('v2', '2023-04-18 23:25:13', 69),
('v2', '2023-04-18 23:25:43', 69),
('v2', '2023-04-18 23:26:13', 69),
('v2', '2023-04-18 23:26:43', 69),
('v2', '2023-04-18 23:27:13', 69.1),
('v2', '2023-04-18 23:27:43', 69),
('v2', '2023-04-18 23:28:13', 69),
('v2', '2023-04-18 23:28:43', 69),
('v2', '2023-04-18 23:29:13', 69),
('v2', '2023-04-18 23:29:44', 69),
('v2', '2023-04-18 23:30:23', 69),
('v2', '2023-04-18 23:30:55', 69),
('v2', '2023-04-18 23:31:23', 69),
('v2', '2023-04-18 23:31:53', 68.9),
('v2', '2023-04-18 23:32:23', 68.9),
('v2', '2023-04-18 23:32:53', 69),
('v2', '2023-04-18 23:33:23', 69),
('v2', '2023-04-18 23:33:53', 69),
('v2', '2023-04-18 23:34:23', 68.9),
('v2', '2023-04-18 23:36:08', 69.1),
('v2', '2023-04-18 23:36:38', 69.1),
('v2', '2023-04-18 23:37:09', 69.1),
('v2', '2023-04-18 23:39:18', 69.1),
('v2', '2023-04-18 23:42:20', 69.4),
('v2', '2023-04-18 23:42:50', 69.3),
('v2', '2023-04-18 23:43:20', 69.3),
('v2', '2023-04-18 23:43:50', 69.3),
('v2', '2023-04-18 23:44:20', 69.2),
('v2', '2023-04-18 23:44:50', 69.3),
('v2', '2023-04-18 23:45:44', 69.4),
('v2', '2023-04-18 23:46:47', 69.5),
('v2', '2023-04-18 23:47:17', 69.5),
('v2', '2023-04-18 23:48:39', 69.5),
('v2', '2023-04-18 23:49:09', 69.5),
('v2', '2023-04-18 23:49:57', 69.4),
('v2', '2023-04-18 23:51:30', 69.3),
('v2', '2023-04-18 23:52:37', 69.3),
('v2', '2023-04-18 23:53:07', 69.3),
('v2', '2023-04-18 23:53:39', 69.3),
('v2', '2023-04-18 23:54:08', 69.4),
('v2', '2023-04-18 23:54:37', 69.3),
('v2', '2023-04-18 23:55:07', 69.3),
('v2', '2023-04-18 23:55:37', 69.4),
('v2', '2023-04-18 23:56:07', 69.4),
('v2', '2023-04-18 23:56:37', 69.4),
('v2', '2023-04-18 23:57:07', 69.5),
('v2', '2023-04-18 23:59:53', 69.3),
('v2', '2023-04-19 00:00:23', 69.4),
('v2', '2023-04-19 00:00:53', 69.4),
('v2', '2023-04-19 00:01:23', 69.4),
('v2', '2023-04-19 00:02:34', 69.4),
('v2', '2023-04-19 00:03:04', 69.3),
('v2', '2023-04-19 00:03:34', 69.3),
('v2', '2023-04-19 00:04:05', 69.3),
('v3', '2023-04-18 23:12:47', 0),
('v3', '2023-04-18 23:14:48', 0),
('v3', '2023-04-18 23:15:17', 0),
('v3', '2023-04-18 23:15:47', 0),
('v3', '2023-04-18 23:16:17', 0),
('v3', '2023-04-18 23:16:47', 0),
('v3', '2023-04-18 23:17:17', 9),
('v3', '2023-04-18 23:17:47', 25),
('v3', '2023-04-18 23:18:17', 19),
('v3', '2023-04-18 23:18:47', 0),
('v3', '2023-04-18 23:19:17', 0),
('v3', '2023-04-18 23:19:46', 0),
('v3', '2023-04-18 23:20:16', 0),
('v3', '2023-04-18 23:20:47', 0),
('v3', '2023-04-18 23:21:17', 0),
('v3', '2023-04-18 23:21:46', 0),
('v3', '2023-04-18 23:22:16', 0),
('v3', '2023-04-18 23:24:13', 0),
('v3', '2023-04-18 23:24:43', 0),
('v3', '2023-04-18 23:25:13', 0),
('v3', '2023-04-18 23:25:43', 0),
('v3', '2023-04-18 23:26:13', 0),
('v3', '2023-04-18 23:26:43', 0),
('v3', '2023-04-18 23:27:13', 0),
('v3', '2023-04-18 23:27:43', 0),
('v3', '2023-04-18 23:28:13', 0),
('v3', '2023-04-18 23:28:43', 0),
('v3', '2023-04-18 23:29:13', 0),
('v3', '2023-04-18 23:29:43', 0),
('v3', '2023-04-18 23:30:23', 0),
('v3', '2023-04-18 23:30:53', 0),
('v3', '2023-04-18 23:31:23', 0),
('v3', '2023-04-18 23:31:53', 0),
('v3', '2023-04-18 23:32:23', 0),
('v3', '2023-04-18 23:32:53', 0),
('v3', '2023-04-18 23:33:23', 0),
('v3', '2023-04-18 23:33:53', 0),
('v3', '2023-04-18 23:34:23', 0),
('v3', '2023-04-18 23:36:07', 0),
('v3', '2023-04-18 23:36:38', 0),
('v3', '2023-04-18 23:37:08', 0),
('v3', '2023-04-18 23:39:18', 0),
('v3', '2023-04-18 23:42:22', 0),
('v3', '2023-04-18 23:42:50', 0),
('v3', '2023-04-18 23:43:20', 0),
('v3', '2023-04-18 23:43:50', 0),
('v3', '2023-04-18 23:44:20', 0),
('v3', '2023-04-18 23:44:50', 0),
('v3', '2023-04-18 23:45:43', 0),
('v3', '2023-04-18 23:46:47', 0),
('v3', '2023-04-18 23:47:17', 0),
('v3', '2023-04-18 23:48:39', 0),
('v3', '2023-04-18 23:49:09', 0),
('v3', '2023-04-18 23:49:54', 0),
('v3', '2023-04-18 23:51:30', 0),
('v3', '2023-04-18 23:52:37', 0),
('v3', '2023-04-18 23:53:08', 0),
('v3', '2023-04-18 23:53:39', 0),
('v3', '2023-04-18 23:54:08', 0),
('v3', '2023-04-18 23:54:38', 0),
('v3', '2023-04-18 23:55:07', 0),
('v3', '2023-04-18 23:55:37', 0),
('v3', '2023-04-18 23:56:07', 0),
('v3', '2023-04-18 23:56:37', 0),
('v3', '2023-04-18 23:57:07', 0),
('v3', '2023-04-18 23:59:53', 0),
('v3', '2023-04-19 00:00:23', 0),
('v3', '2023-04-19 00:00:53', 0),
('v3', '2023-04-19 00:01:23', 0),
('v3', '2023-04-19 00:02:35', 0),
('v3', '2023-04-19 00:03:06', 0),
('v3', '2023-04-19 00:03:35', 0),
('v3', '2023-04-19 00:04:05', 0),
('v4', '2023-04-18 23:12:49', 21),
('v4', '2023-04-18 23:14:48', 21),
('v4', '2023-04-18 23:15:17', 21),
('v4', '2023-04-18 23:15:47', 21),
('v4', '2023-04-18 23:16:17', 21),
('v4', '2023-04-18 23:16:47', 26),
('v4', '2023-04-18 23:17:17', 100),
('v4', '2023-04-18 23:17:47', 11),
('v4', '2023-04-18 23:18:17', 87),
('v4', '2023-04-18 23:18:47', 21),
('v4', '2023-04-18 23:19:18', 89),
('v4', '2023-04-18 23:19:47', 20),
('v4', '2023-04-18 23:20:16', 20),
('v4', '2023-04-18 23:20:46', 21),
('v4', '2023-04-18 23:21:16', 21),
('v4', '2023-04-18 23:21:46', 21),
('v4', '2023-04-18 23:22:16', 21),
('v4', '2023-04-18 23:24:13', 21),
('v4', '2023-04-18 23:24:43', 21),
('v4', '2023-04-18 23:25:13', 21),
('v4', '2023-04-18 23:25:43', 21),
('v4', '2023-04-18 23:26:13', 21),
('v4', '2023-04-18 23:26:43', 21),
('v4', '2023-04-18 23:27:13', 21),
('v4', '2023-04-18 23:27:43', 21),
('v4', '2023-04-18 23:28:13', 21),
('v4', '2023-04-18 23:28:44', 21),
('v4', '2023-04-18 23:29:13', 21),
('v4', '2023-04-18 23:29:43', 21),
('v4', '2023-04-18 23:30:23', 21),
('v4', '2023-04-18 23:30:53', 21),
('v4', '2023-04-18 23:31:23', 21),
('v4', '2023-04-18 23:31:53', 21),
('v4', '2023-04-18 23:32:23', 21),
('v4', '2023-04-18 23:32:53', 21),
('v4', '2023-04-18 23:33:23', 21),
('v4', '2023-04-18 23:33:53', 21),
('v4', '2023-04-18 23:34:23', 21),
('v4', '2023-04-18 23:34:53', 21),
('v4', '2023-04-18 23:36:08', 22),
('v4', '2023-04-18 23:36:38', 22),
('v4', '2023-04-18 23:37:08', 0),
('v4', '2023-04-18 23:39:18', 0),
('v4', '2023-04-18 23:42:20', 0),
('v4', '2023-04-18 23:42:50', 0),
('v4', '2023-04-18 23:43:20', 0),
('v4', '2023-04-18 23:43:50', 0),
('v4', '2023-04-18 23:44:20', 0),
('v4', '2023-04-18 23:44:50', 0),
('v4', '2023-04-18 23:45:43', 0),
('v4', '2023-04-18 23:46:47', 0),
('v4', '2023-04-18 23:47:17', 0),
('v4', '2023-04-18 23:48:39', 0),
('v4', '2023-04-18 23:49:10', 0),
('v4', '2023-04-18 23:49:56', 0),
('v4', '2023-04-18 23:51:30', 0),
('v4', '2023-04-18 23:52:37', 0),
('v4', '2023-04-18 23:53:07', 0),
('v4', '2023-04-18 23:53:37', 0),
('v4', '2023-04-18 23:54:08', 0),
('v4', '2023-04-18 23:54:38', 0),
('v4', '2023-04-18 23:55:07', 0),
('v4', '2023-04-18 23:55:37', 0),
('v4', '2023-04-18 23:56:07', 0),
('v4', '2023-04-18 23:56:37', 0),
('v4', '2023-04-18 23:57:07', 0),
('v4', '2023-04-18 23:59:53', 0),
('v4', '2023-04-19 00:00:23', 0),
('v4', '2023-04-19 00:00:54', 0),
('v4', '2023-04-19 00:01:24', 0),
('v4', '2023-04-19 00:02:35', 0),
('v4', '2023-04-19 00:03:07', 0),
('v4', '2023-04-19 00:03:35', 0),
('v4', '2023-04-19 00:04:05', 0);